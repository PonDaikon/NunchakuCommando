(function(){const id=new URLSearchParams(location.search).get('id');const root=document.getElementById('article');if(!id){root.innerHTML='<p>記事IDが指定されていません。</p>';return;}fetch('./blog.json',{cache:'no-store'}).then(r=>r.json()).then(d=>{const a=(d.articles||[]).find(x=>x.id===id);if(!a){root.innerHTML='<p>記事が見つかりません。</p>';return;}document.title=`${a.title}｜ブログ｜ヌンチャクコマンドー`;document.getElementById('title').textContent=a.title;document.getElementById('date').textContent=a.date;document.getElementById('cats').innerHTML=(a.categories||[]).map(c=>`<span class='badge'>${c}</span>`).join(' ');if(a.cover){document.getElementById('cover-wrap').innerHTML=`<img src='${a.cover}' alt='${a.title}のカバー画像'>`;}const cano=document.getElementById('canonical');if(cano) cano.setAttribute('href', a.url||location.href);return fetch(`./posts/${id}.html`,{cache:'no-store'});}).then(r=>r?r.text():'').then(h=>{if(h){document.getElementById('content').innerHTML=h;}}).catch(e=>{console.error(e);document.getElementById('content').innerHTML='<p>本文の読み込みに失敗しました。</p>';});})();